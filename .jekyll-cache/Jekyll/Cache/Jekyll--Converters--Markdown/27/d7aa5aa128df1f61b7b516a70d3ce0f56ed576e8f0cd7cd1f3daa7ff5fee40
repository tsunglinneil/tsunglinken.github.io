I"ÚO<p><strong>å‰è¨€</strong></p>

<p>æœ¬æ–‡è‘—é‡æ–¼ä½¿ç”¨ Mockito æ¸¬è©¦æ¡†æ¶å”åŠ©æ’°å¯«å–®å…ƒæ¸¬è©¦(Unit Test)ï¼Œæ•´åˆæ¸¬è©¦(Integration Test)ä¹Ÿç›¸ç•¶é‡è¦ï¼Œé—œæ–¼å–®å…ƒæ¸¬è©¦åŠæ•´åˆæ¸¬è©¦å„è‡ªç‰¹æ€§ä¸¦ä¸åœ¨æœ¬æ–‡è¨è«–çš„ç¯„åœå…§ï¼Œæœ¬æ–‡æœŸè¨±è—‰ç”±ç°¡å–®çš„ç¯„ä¾‹ä¾†èªè­˜ Mockitoï¼Œæé«˜é–‹ç™¼è€…å°æ–¼é€™ä¸€å€å¡Šçš„é—œæ³¨åŠè¨è«–ç¨‹åº¦ã€‚</p>

<p><strong>Mock ç¨®é¡</strong></p>

<p>åœ¨æ­£å¼é–‹å§‹é€²å…¥ä¸»é¡Œä¹‹å‰ï¼Œéœ€è¦å…ˆå° Test Double æœ‰äº›è¨±æ¦‚å¿µï¼Œç”±æ–¼åœ¨ Mockito ä¸­å°‡å¤§éƒ¨åˆ†çš„ Test Doubles éƒ½ä»¥ Mock å–ä»£ä¹‹ï¼Œè€Œ Test Doubles ä¸¦éåªæœ‰ Mock ä¸€ç¨®è€Œå·²ï¼Œä»¥ä¸‹å‰‡é–‹å§‹é‡å° Test Double åšå€‹èªªæ˜ã€‚</p>

<p>â€¢ Dummy</p>

<p>ä¸åŒ…å«å¯¦ä½œçš„ç‰©ä»¶(åŒ…å« NULLï¼‰ï¼Œç›®çš„ç‚ºåœ¨æ¸¬è©¦ä¸­å‚³å…¥ä½†æ˜¯å¯¦éš›ä¸æœƒè¢«ä½¿ç”¨åˆ°çš„ç‰©ä»¶ï¼Œä½¿ä¹‹æˆåŠŸç·¨è­¯ã€‚</p>

<p>â€¢ Stub</p>

<p>ç•¶ä½ çš„ SUT æœ‰ä¾è³´ DOC æ™‚ï¼Œç”¨ä¾†æ›¿ä»£çœŸå¯¦ DOC çš„ç‰©ä»¶ï¼Œä¸¦ä¸”æŒ‡å®šæ¸¬è©¦éç¨‹çš„å›å‚³å€¼ã€‚</p>

<p>â€¢ Mock</p>

<p>å»ºç«‹ä¸€å€‹å®Œå…¨æ¨¡æ“¬çš„ç‰©ä»¶ï¼Œèˆ‡ Stub ä¸åŒçš„æ˜¯ï¼ŒStub æä¾›ä½ çš„æ¸¬è©¦æ¡ˆä¾‹å›å‚³å€¼ï¼ŒMock å‰‡é—œæ³¨ã€é©—è­‰è¡Œç‚ºã€ã€‚</p>

<p>â€¢ Spy</p>

<p>å¯ä»¥ã€è¨˜éŒ„ã€ä¸¦ã€é©—è­‰ã€èˆ‡å¾…æ¸¬å°è±¡äº’å‹•çš„è¡Œç‚ºï¼Œèˆ‡ Mock é¡ä¼¼ä½†æ˜¯ Mockito ä¸­ Spy ç‰©ä»¶ä¸¦ä¸æ˜¯ Mock ç‰©ä»¶ï¼ŒSpy æ‰€å‰µå»ºçš„æ˜¯çœŸå¯¦çš„ç‰©ä»¶ã€‚</p>

<p>â€¢ Fake</p>

<p>é€šå¸¸ç‚ºè‡ªè¡Œå¯¦ä½œä¸¦ä¸”åƒ…ç”¨æ–¼æ›¿ä»£ Production ç’°å¢ƒä¸­çš„è¼•é‡åŒ–ç‰©ä»¶ï¼Œèˆ‰å€‹ä¾‹å­ï¼šIn-memory databaseã€‚</p>

<p><strong>Mockito ?</strong></p>

<p>å¾ˆå»£æ³›è¢«ä½¿ç”¨çš„æ¸¬è©¦æ¡†æ¶ï¼Œå°¤å…¶èƒ½å¤ å¾ˆå®¹æ˜“çš„è™•ç†ä¾è³´æ³¨å…¥çš„æƒ…å¢ƒï¼Œå°æ–¼ä½¿ç”¨ Spring Framework çš„é–‹ç™¼è€…ä¾†èªªï¼Œç”¨ä¾†æ­é…æ’°å¯« Unit Test ç›¸å°æœ‰å¹«åŠ©ï¼Œç•¶é–‹ç™¼è€…é‡åˆ°ä¾è³´æ³¨å…¥æƒ…å¢ƒæ™‚å¾€å¾€æœƒç›´æ¥ä½¿ç”¨ã€å¯¦éš›ç‰©ä»¶ã€ä¾†é€²è¡Œæ¸¬è©¦ï¼Œè€Œäº‹å¯¦ä¸Šé€™æ¨£çš„æ“ä½œæ˜¯å†é€²è¡Œ Integration Testï¼Œä¸¦é Unit Testã€‚å¦å¤– Mockito ä¹Ÿæ‰®æ¼”è‘—å”åŠ©é–‹ç™¼è€…èƒ½å¤ æ›´å®¹æ˜“åœ°è™•ç†ä¸¦ä¸”å»ºæ§‹å„å¼ Test Double ä¾†é€²è¡Œ Unit Testã€‚</p>

<p><strong>æ¼”ç¤ºç¯„ä¾‹</strong></p>

<p>æœ¬ä¾‹é—œæ³¨åœ¨ Mockito çš„å„ç¨®æ¸¬è©¦ï¼Œåœ¨æ­¤å‰‡ä¸ç‰¹åœ°å¼•ç”¨ Spring ä»¥åŠä»»ä½• ORM ç›¸é—œæ¡†æ¶ã€‚</p>

<p>â€¢ Projectï¼šå°ˆæ¡ˆçµæ§‹ã€‚</p>

<div><img src="/images/mockito/project.png" width="800" height="150" alt="" /></div>

<p>â€¢ Maven Dependencyï¼š (åœ¨æ­¤ç¯„ä¾‹ä¸­ä½¿ç”¨ Junit 5)ã€‚</p>

<div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.mockito<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>mockito-core<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>2.23.0<span class="nt">&lt;/version&gt;</span>
            <span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.mockito<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>mockito-junit-jupiter<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>2.23.0<span class="nt">&lt;/version&gt;</span>
            <span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div>

<p>â€¢ Serviceï¼šå‘¼å« Repository èˆ‡è³‡æ–™åº«é€²è¡Œäº¤äº’å–å¾—è³‡è¨Šã€‚</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">service.jpa</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">model.Custom</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">repository.CustomRepository</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">service.ICustomJpaService</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.HashSet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Set</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CustomJpaService</span> <span class="kd">implements</span> <span class="nc">ICustomJpaService</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">CustomRepository</span> <span class="n">customRepository</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">CustomJpaService</span><span class="o">(</span><span class="nc">CustomRepository</span> <span class="n">customRepository</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">customRepository</span> <span class="o">=</span> <span class="n">customRepository</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">Custom</span><span class="o">&gt;</span> <span class="nf">findAll</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">Custom</span><span class="o">&gt;</span> <span class="n">customs</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashSet</span><span class="o">&lt;&gt;();</span>
        <span class="n">customRepository</span><span class="o">.</span><span class="na">findAll</span><span class="o">().</span><span class="na">forEach</span><span class="o">(</span><span class="nl">customs:</span><span class="o">:</span><span class="n">add</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">customs</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">Custom</span> <span class="nf">findById</span><span class="o">(</span><span class="nc">Long</span> <span class="n">aLong</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">customRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">aLong</span><span class="o">).</span><span class="na">orElse</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">Custom</span> <span class="nf">save</span><span class="o">(</span><span class="nc">Custom</span> <span class="n">object</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">customRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">object</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">delete</span><span class="o">(</span><span class="nc">Custom</span> <span class="n">object</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">customRepository</span><span class="o">.</span><span class="na">delete</span><span class="o">(</span><span class="n">object</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">deleteById</span><span class="o">(</span><span class="nc">Long</span> <span class="n">aLong</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">customRepository</span><span class="o">.</span><span class="na">deleteById</span><span class="o">(</span><span class="n">aLong</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>â€¢ Repositoryï¼šèˆ‡è³‡æ–™åº«æºé€šå–å¾—è³‡æ–™(é€™è£¡æ¨¡æ“¬ Spring Data Jpa çš„è¡Œç‚ºï¼Œä¸¦ç„¡å¯¦éš›å¼•ç”¨è©²æ¡†æ¶)ã€‚</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">repository</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">model.Custom</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">CustomRepository</span> <span class="kd">extends</span> <span class="nc">CrudRepository</span><span class="o">&lt;</span><span class="nc">Custom</span><span class="o">,</span> <span class="nc">Long</span><span class="o">&gt;</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre></div></div>

<p>â€¢ Modelï¼šå³ Entityã€‚</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">model</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Custom</span> <span class="kd">extends</span> <span class="nc">BaseEntity</span><span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">email</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Custom</span><span class="o">(</span><span class="nc">Long</span> <span class="n">id</span><span class="o">,</span> <span class="nc">String</span> <span class="n">name</span><span class="o">,</span> <span class="nc">String</span> <span class="n">email</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">email</span> <span class="o">=</span> <span class="n">email</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Long</span> <span class="nf">getId</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getEmail</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">email</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>æ’°å¯« Unit Test By Mockito</strong></p>

<p>é‡å° CustomJpaService æ’°å¯«æ¸¬è©¦ã€‚</p>

<p>â€¢ Inject Mocks</p>

<p>æ­¤ä¾‹ä¸­ Service å‘¼å«å…¶ä¾è³´é …ç›® Repository å–å¾—æˆ–ç•°å‹•è³‡æ–™åº«è³‡è¨Šï¼Œé€™è£¡é—œæ³¨å¾…æ¸¬ç‰©ä»¶ Service å‘¼å«æ–¹æ³•åŸ·è¡Œæ™‚æ˜¯å¦ç¬¦åˆé æœŸçµæœï¼Œå› æ­¤æˆ‘å€‘éœ€è¦å°å…¶ä¾è³´(Repository)é€²è¡Œ Mocksã€‚</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">service.jpa</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">model.Custom</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.extension.ExtendWith</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.mockito.InjectMocks</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.mockito.Mock</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.mockito.junit.jupiter.MockitoExtension</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">repository.CustomRepository</span><span class="o">;</span>

<span class="nd">@ExtendWith</span><span class="o">(</span><span class="nc">MockitoExtension</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">CustomJpaServiceTest</span> <span class="o">{</span>
    <span class="nd">@Mock</span>
    <span class="nc">CustomRepository</span> <span class="n">customRepository</span><span class="o">;</span>

    <span class="nd">@InjectMocks</span>
    <span class="nc">CustomJpaService</span> <span class="n">customJpaService</span><span class="o">;</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">delete</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">customJpaService</span><span class="o">.</span><span class="na">delete</span><span class="o">(</span><span class="k">new</span> <span class="nc">Custom</span><span class="o">(</span><span class="mi">1</span><span class="n">l</span><span class="o">,</span> <span class="s">"Adele"</span><span class="o">,</span> <span class="s">"adele@gmail.com"</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>èªªæ˜ï¼š</p>

<p>line 11 @ExtendWith: JUnit 5 æä¾›æ‹“å±•é»çš„æ¶æ§‹ï¼Œåˆ©ç”¨æ­¤ Annotation æä¾›æ‹“å±•æ€§ï¼Œè®“ç¬¬ä¸‰æ–¹ä¹Ÿèƒ½å¤ å¯¦ç¾ JUnit Jupiter APIï¼Œåœ¨æ­¤æˆ‘å€‘å‰‡ä½¿ç”¨ Mockito Extentionã€‚</p>

<p>line 13 @Mock: å»ºç«‹ Mock ç‰©ä»¶ã€‚</p>

<p>line 16 @InjectMocks: æ³¨å…¥ Mock ç‰©ä»¶ã€‚</p>

<p>line 19 å®šç¾©æ¸¬è©¦</p>

<p>line 23 åŸ·è¡Œå¾…æ¸¬ç‰©ä»¶</p>

<p>åœ¨ Debug æ¨¡å¼ä¸‹é€²è¡Œæª¢æŸ¥ï¼Œå¯ä»¥çœ‹åˆ° CustomRepository æˆåŠŸåœ°è¢« Mock ä¸¦ä¸”æ³¨å…¥åˆ° CustomJpaServiceã€‚</p>

<div><img src="/images/mockito/inject-mock1.png" width="800" height="150" alt="" /></div>

<p>æ¸¬è©¦çµæœï¼šPassã€‚</p>

<div><img src="/images/mockito/inject-mock2.png" width="800" height="150" alt="" /></div>

<p>â€¢ Verify Mocks</p>

<p>ç›®çš„ç‚ºé©—è­‰ Mock ç‰©ä»¶è¢«åŸ·è¡Œå‘¼å«çš„æƒ…æ³æ˜¯å¦ç¬¦åˆé æœŸçµæœã€‚</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">deleteById</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">customJpaService</span><span class="o">.</span><span class="na">deleteById</span><span class="o">(</span><span class="mi">1</span><span class="n">l</span><span class="o">);</span>
        <span class="n">verify</span><span class="o">(</span><span class="n">customRepository</span><span class="o">,</span> <span class="n">times</span><span class="o">(</span><span class="mi">1</span><span class="o">)).</span><span class="na">deleteById</span><span class="o">(</span><span class="mi">1</span><span class="n">l</span><span class="o">);</span>
    <span class="o">}</span>
</code></pre></div></div>

<p>èªªæ˜ï¼š</p>

<p>line 4 é©—è­‰å¾…æ¸¬ç‰©ä»¶ customJpaService å‘¼å« deleteById æ™‚ï¼ŒMock ç‰©ä»¶ customRepository è¢«åŸ·è¡Œäº†å¹¾æ¬¡ï¼Œtimes(1)è¡¨ç¤ºè¢«å‘¼å«åŸ·è¡Œäº†ä¸€æ¬¡ï¼Œverify é è¨­è¡Œç‚ºæ˜¯ times(1)ï¼Œåœ¨æ­¤ç‚ºäº†æ¼”ç¤ºæ‰€ä»¥æ²’æœ‰çœç•¥ã€‚</p>

<p>æ¸¬è©¦çµæœï¼šPassã€‚</p>

<div><img src="/images/mockito/verify-mock.png" width="800" height="150" alt="" /></div>

<p>â€¢ Mocks å›å‚³å€¼</p>

<p>ç›®çš„ç‚ºä¾æ“šæ¸¬è©¦æƒ…å¢ƒé å…ˆå®šç¾© Mock å›å‚³å€¼ã€‚</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">findAll</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">Custom</span><span class="o">&gt;</span> <span class="n">customSet</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashSet</span><span class="o">&lt;&gt;();</span>

        <span class="n">when</span><span class="o">(</span><span class="n">customRepository</span><span class="o">.</span><span class="na">findAll</span><span class="o">()).</span><span class="na">thenReturn</span><span class="o">(</span><span class="n">customSet</span><span class="o">);</span>

        <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">Custom</span><span class="o">&gt;</span> <span class="n">returnCustomSet</span> <span class="o">=</span> <span class="n">customJpaService</span><span class="o">.</span><span class="na">findAll</span><span class="o">();</span>

        <span class="n">assertThat</span><span class="o">(</span><span class="n">returnCustomSet</span><span class="o">).</span><span class="na">isNotNull</span><span class="o">();</span>

        <span class="n">verify</span><span class="o">(</span><span class="n">customRepository</span><span class="o">).</span><span class="na">findAll</span><span class="o">();</span>
    <span class="o">}</span>
</code></pre></div></div>

<p>èªªæ˜ï¼š</p>

<p>line 3 å®šç¾©å›å‚³ç‰©ä»¶ã€‚</p>

<p>line 5 æŒ‡å®š Mock ç‰©ä»¶å›å‚³å€¼ï¼Œç•¶ customRepository å‘¼å« findAll()ï¼Œå‰‡å›å‚³ line 37 å®šç¾©çš„ç‰©ä»¶ã€‚</p>

<p>line 7 åŸ·è¡Œå¾…æ¸¬ç‰©ä»¶çš„å‘¼å«ã€‚</p>

<p>line 9 é©—è­‰å›å‚³å€¼çµæœï¼Œé€™è£¡ä½¿ç”¨ assertj é€²è¡Œæ–·è¨€ã€‚</p>

<p>line 11 å¦‚åŒä¸Šä¸€å€‹ topic æ‰€æåŠä¹‹ Verify Mocks çš„é©—è­‰è¡Œç‚ºã€‚</p>

<p>æ¸¬è©¦çµæœï¼šPassã€‚</p>

<div><img src="/images/mockito/mock-return.png" width="800" height="150" alt="" /></div>

<p>â€¢ Argument Machers</p>

<p>ç›®çš„ç‚ºé©—è­‰ Mock ç‰©ä»¶çš„åƒæ•¸æ˜¯å¦ç¬¦åˆé æœŸã€‚</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">testArgumentMatcherByDelete</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Custom</span> <span class="n">custom</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Custom</span><span class="o">(</span><span class="mi">1</span><span class="n">l</span><span class="o">,</span> <span class="s">"Adele"</span><span class="o">,</span> <span class="s">"adele@gmail.com"</span><span class="o">);</span>

        <span class="n">customJpaService</span><span class="o">.</span><span class="na">delete</span><span class="o">(</span><span class="n">custom</span><span class="o">);</span>

        <span class="n">verify</span><span class="o">(</span><span class="n">customRepository</span><span class="o">).</span><span class="na">delete</span><span class="o">(</span><span class="n">any</span><span class="o">(</span><span class="nc">Custom</span><span class="o">.</span><span class="na">class</span><span class="o">));</span>
    <span class="o">}</span>
</code></pre></div></div>

<p>èªªæ˜ï¼š</p>

<p>æ­¤ä¾‹ä½¿ç”¨ any(Class<T> type)ï¼Œä¸¦æŒ‡å®šå‚³å…¥åƒæ•¸å¿…é ˆè¦æ˜¯ Custom çš„é¡å‹ï¼ŒMockito æä¾›äº†éå¸¸å¤šçš„åƒæ•¸é©—è­‰é¡å‹ï¼Œä¾æ“šå„ç¨®éœ€æ±‚é¸æ“‡åˆé©çš„æ–¹æ³•å³å¯ã€‚</T></p>

<p>ä»¥ä¸‹åˆ—å‡ºå¯ä½¿ç”¨çš„æ–¹æ³•ï¼š</p>

<div><img src="/images/mockito/argument-machers1.png" width="800" height="150" alt="" /></div>

<p>æ¸¬è©¦çµæœï¼šPassã€‚</p>

<div><img src="/images/mockito/argument-machers2.png" width="800" height="150" alt="" /></div>

<p><strong>æœ¬ç¯‡é‡é»</strong></p>

<ol>
  <li>
    <p>èªè­˜ Mock ç¨®é¡</p>
  </li>
  <li>
    <p>Maven é…ç½®ä½¿ç”¨ Mockito</p>
  </li>
  <li>
    <p>å„é … Annotation ä½¿ç”¨</p>
  </li>
</ol>

<p>â€¢Â @ExtendWith</p>

<p>â€¢ @Mock</p>

<p>â€¢ @InjectMocks</p>

<ol>
  <li>Mockito å¯¦éš›æ¡ˆä¾‹</li>
</ol>

<p>â€¢ å¦‚ä½•å¯¦ç¾ Dependency Inject</p>

<p>â€¢ Verify</p>

<p>â€¢ Return Value</p>

<p>â€¢ Argument Machers</p>

<p>Mockito Unit Test çš„ä»‹ç´¹åŠå¯¦ä½œè‡³æ­¤ï¼Œæ—¥å¾Œæœ‰æ©Ÿæœƒå†æ¥è‘—åˆ†äº« Mockito BDD Styleã€‚</p>
:ET